package packet.packets

import JsonFeature
import by
import kotlinx.serialization.SerialName
import kotlinx.serialization.Serializable
import kotlinx.serialization.json.Json
import kotlinx.serialization.json.JsonObject
import kotlinx.serialization.json.encodeToJsonElement
import kotlinx.serialization.json.jsonObject
import packet.Packet
import service.model.User
import packet.PacketIdentifier
/**
 * 无尽挑战上传本地可携带植物
 *
 * @property l 起始关卡, 默认为 0
 * @property pl 植物列表
 */
@PacketIdentifier("V318")
class V318(override val user: User) : Packet() {
    override val identifier: String = "V318"

    /**
     * 起始关卡, 默认为 0
     *
     * ```
     * l = "0"
     * ```
     */
    var l: String = "0"

    /**
     * 植物列表, 包含一个默认值, 但该默认值不能兼容所有账号
     *
     * ```
     * pl = listOf( /* 植物 id */ )
     * ```
     */
    var pl: List<Int> = listOf(
        1002,
        1001,
        1003,
        1004,
        1005,
        1006,
        1007,
        111029,
        111019,
        200012,
        111033,
        1018,
        1009,
        1021,
        1010,
        1020,
        111062,
        1011,
        1012,
        1052,
        200022,
        1028,
        1030,
        1029,
        111071,
        1093,
        111044,
        1067,
        111032,
        1097,
        1076,
        1008,
        1014,
        1015,
        1017,
        1023,
        1025,
        1027,
        1034,
        1039,
        1045,
        1064,
        1065,
        1072,
        111002,
        111010,
        111020,
        111022,
        111024,
        111034,
        111035,
        111039,
        111045,
        111047,
        111048,
        111050,
        111051,
        111058,
        111060,
        111063,
        111065,
        111066,
        111070,
        111074,
        111078,
        111086,
        111087,
        111089,
        111090,
        200000,
        200001,
        200002,
        200004,
        200007,
        200009,
        200010,
        200013,
        200014,
        200020,
        200021,
        200023,
        200028,
        200029,
        200032,
        200033,
        200034,
        200035,
        200037,
        200038,
        200039,
        200041,
        200043,
        1031,
        1058,
        1092,
        1089,
        200027,
        200011,
        1026,
        200044,
        111038,
        200024,
        1013,
        1022,
        1035,
        111006,
        111011,
        111052,
        200045,
        1099,
        111067,
        1033,
        1019,
        1068,
        1075,
        1041,
        1066,
        111064,
        200046,
        111016,
        111040,
        111088,
        1016,
        1042,
        1044,
        1050,
        1051,
        1055,
        1056,
        1057,
        1069,
        1078,
        1079,
        1080,
        1083,
        1090,
        1091,
        1094,
        111009,
        111012,
        111014,
        111025,
        111027,
        111028,
        111037,
        111041,
        111056,
        111069,
        111091,
        200003,
        200031,
        1024,
        1036,
        1043,
        1037,
        1047,
        1040,
        1053,
        1049,
        1059,
        1054,
        1060,
        1032,
        1062,
        1061,
        1070,
        1063,
        1073,
        1071,
        1077,
        1074,
        1081,
        1082,
        1085,
        1084,
        1086,
        1088,
        1095,
        1098,
        111001,
        111003,
        111013,
        111004,
        111015,
        111008,
        111018,
        111017,
        111021,
        111031,
        111030,
        111023,
        111036,
        111026,
        111043,
        111042,
        111046,
        111049,
        111055,
        111054,
        111061,
        111053,
        111085,
        111084,
        111073,
        111072,
        111081,
        200005,
        200026,
        111075,
        111068,
        111076,
        111082,
        111079,
        200030,
        200008,
        200006,
        200017,
        200015,
        200016,
        200018,
        200025,
        200019,
        200047,
        200048,
        200051,
        200054,
        200055,
        200050,
        200049,
        200057,
        200056,
        200059,
        200053,
        200058,
        200052,
        200062,
        200066,
        200061,
        200067,
        200069,
        200065,
        200070,
        200068,
        200064,
        200063,
        200060,
        200071,
        200072,
        200073,
        200074,
        200075,
        200076,
        200077,
        200078,
        200079,
        200080,
        200082,
        200083,
        200084
    )

    @Serializable
    data class Data(
        @SerialName("acd") val acd: Acd = Acd(),
        @SerialName("l") val l: String = "0",
        @SerialName("pi") val pi: String,
        @SerialName("pl") val pl: List<Int>,
        @SerialName("sk") val sk: String,
        @SerialName("ui") val ui: String,
    ) {
        @Serializable
        data class Acd(
            @SerialName("g") val g: Int = 0,
        )
    }

    override fun build(): Pair<String, JsonObject> = identifier to Json.by(JsonFeature.EncodeDefaults).encodeToJsonElement(
        Data(
            l = l,
            pl = pl,
            pi = user.credential.personalId,
            sk = user.credential.securityKey,
            ui = user.credential.userId,
        )
    ).jsonObject
}

